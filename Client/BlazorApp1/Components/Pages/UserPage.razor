@page "/user"
@inject BlazorApp1.Services.IUserService UserService
@using ApiContracts.UserFolder

<h3>Add User (Test)</h3>

<button class="btn btn-primary" @onclick="CreateUser">Add User</button>

@if (!string.IsNullOrEmpty(message))
{
    <p>@message</p>
}

@code {
   private string? message;
    private CreateUserDTO newUser = new()
    {
        Username = string.Empty,
        Password = 0
    };
    private string? passwordInput;

    private async Task CreateUser()
    {
        try
        {

            if (int.TryParse(passwordInput, out int parsedPassword))
            {
                newUser.Password = parsedPassword;
            }
            else
            {
                message = "Password must be a number.";
                return;
            }

            var created = await UserService.AddUserAsync(newUser);
            message = $"User '{created.Username}' created successfully!";
            
         
            newUser = new()
            {
                Username = string.Empty,
                Password = 0
            };
            passwordInput = string.Empty;
        }
        catch (Exception ex)
        {
            message = $"Error: {ex.Message}";
        }
}
}